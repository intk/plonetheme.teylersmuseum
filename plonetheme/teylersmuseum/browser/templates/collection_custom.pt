<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
<body>

  <div metal:fill-slot="content-core"  tal:define="showall python:True"> 
    <metal:block define-macro="content-core"
                 tal:define="kssClassesView context/@@kss_field_decorator_view;
                             getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                             templateId template/getId;
                             portal_type context/portal_type">

    <div class="tileColumns container-fluid">
      <div class="col-lg-12" id="collectionFilters" tal:define="checkPermission nocall: context/portal_membership/checkPermission;
        portal context/@@plone_portal_state/portal;">
        <tal:block replace="structure provider:plonetheme.bootstrapModern.collectionPortletManager"/>
        <a class="managePortletsFallback" tal:attributes="href string:${context/absolute_url}/@@manage-collection-portlets" tal:condition="python:checkPermission('Portlets: Manage portlets', context)">Manage collection portlets</a>
      </div>

      <div class="row-fluid">
      
        <metal:listingmacro define-macro="listing">
        <tal:results define="contentFilter contentFilter|request/contentFilter|nothing;
                 contentFilter python:contentFilter and dict(contentFilter) or {};
                 b_start python:request.get('b_start', 0);
                 sort_on python:request.get('sort_on', 0);
                 limit_display limit_display|request/limit_display|nothing;
                 limit_display python:limit_display and int(limit_display) or None;
                 batch python:view.results(b_start=b_start, pagesize=33, only_documented=not showall);
                 site_properties context/portal_properties/site_properties;
                 use_view_action site_properties/typesUseViewActionInListings|python:();
                 isAnon context/@@plone_portal_state/anonymous;
                 normalizeString nocall: context/plone_utils/normalizeString;
                 toLocalizedTime nocall: context/@@plone/toLocalizedTime;
                 collection_id context/UID;
                 show_about python:not isAnon or site_properties.allowAnonymousViewAbout;
                 navigation_root_url context/@@plone_portal_state/navigation_root_url;
                 pas_member context/@@pas_member;">
        <tal:listing condition="batch">

        <metal:block metal:define-slot="entries">
            <tal:entry tal:repeat="item batch" metal:define-macro="entries">
            <tal:block tal:define="item_id item/getId;
                       item_description item/description;
                       item_type item/Type;
                       item_obj item/getObject;
                       excluded_from_nav python:item_obj.exclude_from_nav;
                       item_person python:item_type == 'Media Person';
                       item_url python:item_type == 'Media Event' and '%s'%item.getURL() or item.getURL();
                       item_modified item/ModificationDate;
                       item_created item/CreationDate;
                       item_icon item/getIcon;
                       item_wf_state_class python:'state-' + normalizeString(item.review_state);
                       item_creator item/Creator;
                       item_start python:(item.start or item.StartDate) if item_type == 'Media Event' else None;
                       item_end python:(item.end) if item_type == 'Media Event' else None;
                       item_modified item/ModificationDate;
                       odd repeat/item/odd;
                       even repeat/item/even;
                       first repeat/item/start;
                       number repeat/item/number;
                       item_img python:view.getImageObject(item);
                       item_link python: (item_type == 'Press Kit' and not view.checkPermission(item, 'Add portal content')) and item_url + '/download_zip' or (item_type in use_view_action and item_url+'/view' or item_url);">
            
            <metal:block define-slot="entry">
            
            <!-- ITEM -->
              <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12" metal:define-macro="listitem">
                <div class="thumbnail">
                  <div class="thumb-wrapper">

                    <a class="thumb-image" tal:condition="python: (item.hasMedia or item.portal_type == 'Image') and not excluded_from_nav and item_img != None" href="" tal:attributes="href python: item_link+'?collection_id='+collection_id+'&b_start='+str(b_start) if portal_type == 'Collection' else item_link"
                      >

                      <img tal:define="images item_img/@@images;
                                         scale python: images.scale('image', scale='preview')"
                             tal:condition="scale"
                             src="" alt=""
                             tal:replace="structure python: scale.tag(css_class='tileImage')" />
                    </a> 

                      <div class="thumb-image" tal:condition="python: (item.hasMedia or item.portal_type == 'Image') and excluded_from_nav and item_img != None"
                        >
                      
                      <img tal:define="images item_img/@@images;
                                         scale python: images.scale('image', scale='preview')"
                             tal:condition="scale"
                             src="" alt=""
                             tal:replace="structure python: scale.tag(css_class='tileImage')" />  
                      </div> 

                      <div class="btn-group person-buttons person-collection" tal:condition="item_person">
                        
                        <a class="btn btn-inverse phone_popover visible-lg visible-md" tal:condition="python: getattr(item.getObject(), 'telephoneNumber', True)" data-toggle="popover" tal:attributes="data-content python: getattr(item.getObject(), 'telephoneNumber')" data-container="body" data-viewport=".phone-popover" data-placement="top"><i class="fa fa-phone"></i></a>

                        <a tal:attributes="href python:'tel:'+getattr(item.getObject(), 'telephoneNumber')" class="btn btn-inverse visible-sm visible-xs" tal:condition="python: getattr(item.getObject(), 'telephoneNumber', True)"><i class="fa fa-phone"></i></a>

                        <a tal:attributes="href python:'https://twitter.com/intent/follow?original_referer=http://www.intk.com&region=follow_link&screen_name='+getattr(item.getObject(), 'twitter')+'&tw_p=followbutton&variant=2.0'" class="btn btn-inverse" tal:condition="python: getattr(item.getObject(), 'twitter', True)"><i class="fa fa-twitter"></i></a>
                        <a tal:attributes="href python:'mailto:'+getattr(item.getObject(), 'email')+'?subject=Contact via INTK website'" class="btn btn-inverse" tal:condition="python: getattr(item.getObject(), 'email', True)"><i class="fa fa-paper-plane"></i></a>
                      </div>    
                          
                  </div>
                  <div class="caption">
                  <h3 tal:condition="not:excluded_from_nav"><a href="#"
                       tal:attributes="href python: item_link+'?collection_id='+collection_id+'&b_start='+str(b_start) if portal_type == 'Collection' else item_link; class item_wf_state_class"
                       tal:content="item/Title"
                       >
                    Title
                    </a>
                  </h3>
                  <h3 tal:condition="excluded_from_nav" tal:content="item/Title">
                    Title
                  </h3>
                    <p>
                      <span tal:condition="python:item.getObject().description != '' " tal:replace="python:view.trimText(item.getObject().description, 200, strip=False)"></span>
                        
                    </p> 
                  </div>
                  
                  
                </div>
            </div>

            <tal:clearfix condition="python: number % 3 == 0">
              <div class="clearfix visible-lg visible-md"></div>
            </tal:clearfix> 

            <tal:clearfixmd condition="python: number % 2 == 0">
              <div class="clearfix visible-sm"></div>
            </tal:clearfixmd>
            
            </metal:block>
            </tal:block>
            </tal:entry>

        </metal:block>
        
        <div metal:use-macro="context/batch_macros/macros/navigation" />
    
        </tal:listing>
        <metal:empty metal:define-slot="no_items_in_listing">
        <p class="discreet"
           tal:condition="not: batch">
            There is currently no content in this section.
        </p>
        </metal:empty>
    
        </tal:results>
        </metal:listingmacro>

    </div>
  </div>
    
    </metal:block>
  </div>

</body>
</html>
